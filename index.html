<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Niko's Market</title>
  <style>
    * { box-sizing: border-box; font-family: Inter, system-ui, -apple-system, sans-serif; }
    body { margin: 0; background: #0b0d12; color: #e7e9ee; }
    header { padding: 16px 24px; border-bottom: 1px solid #1f2430; display: flex; justify-content: space-between; align-items: center; }
    header h1 { font-size: 18px; margin: 0; }
    header a { color: #9aa1b2; text-decoration: none; font-size: 14px; }

    main { padding: 24px; max-width: 1100px; margin: auto; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 16px; }
    .card { background: #121622; border: 1px solid #1f2430; border-radius: 16px; padding: 16px; box-shadow: 0 10px 30px rgba(0,0,0,.25); }
    .card h3 { margin: 0 0 8px; font-size: 16px; }
    .muted { color: #9aa1b2; font-size: 13px; }
    .price { font-weight: 700; margin-top: 6px; }
    .buy { margin-top: 12px; width: 100%; padding: 10px; border-radius: 12px; border: 0; background: #5b7cfa; color: #0b0d12; font-weight: 700; cursor: pointer; }

    .modal { position: fixed; inset: 0; background: rgba(0,0,0,.65); display: none; align-items: center; justify-content: center; }
    .modal.active { display: flex; }
    .modal-box { width: 100%; max-width: 480px; background: #121622; border: 1px solid #1f2430; border-radius: 18px; padding: 20px; }
    .field { margin: 10px 0; }
    .field label { display: block; margin-bottom: 4px; }
    .field input { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #1f2430; background: #0b0d12; color: #e7e9ee; }

    footer { text-align: center; padding: 24px; color: #9aa1b2; font-size: 13px; }
  </style>
</head>
<body>
  <header>
    <h1>Niko's Market</h1>
    <a href="reviews.html">Reviews</a>
  </header>

  <main>
    <h2>Listings</h2>
    <div class="grid" id="listings"></div>
  </main>

  <footer>Robux-only 路 Manual delivery</footer>

  <!-- BUY MODAL -->
  <div class="modal" id="buyModal">
    <div class="modal-box">
      <h2 id="buyTitle"></h2>
      <p class="muted" id="buyDesc"></p>

      <div class="field">
        <label class="muted">Roblox Username</label>
        <input id="rbxUser" />
      </div>

      <div class="field">
        <label class="muted">Email</label>
        <input id="email" />
      </div>

      <div class="field">
        <label class="muted">Discord (optional)</label>
        <input id="discord" />
      </div>

      <div class="field">
        <label class="muted">Amount</label>
        <input id="rbxAmount" disabled />
      </div>

      <button class="buy" onclick="confirmBuy()">Continue</button>
    </div>
  </div>

  <script>
    const WEBHOOK_URL = 'https://discord.com/api/webhooks/1449649730937290815/o0lKm5--nv168XGaAzHJe9BzyhM_xaQTr5Q9knr28Q43lM6BsEHfYGyjoroUx2uJighd';

    const items = [
      { name: 'Nemesis Account', price: 800, desc: 'Basic account 路 Email access', gamepassId: 631477075 },
      { name: 'Mid-Level Account', price: 750, desc: 'Skins 路 Verified', gamepassId: 1049561260 },
      { name: 'High-End Account', price: 2000, desc: 'Rare skins 路 Full access', gamepassId: 1049179885 },
      { name: 'Ranked-Ready Account', price: 250, desc: 'Cheap 路 Ranked Ready', gamepassId: 1049960330 },
      { name: 'High-WR Account', price: 600, desc: 'Comp 路 Weapons', gamepassId: 1049020156 },
      { name: 'High-Streak Account', price: 1500, desc: 'Streak 路 Full Access', gamepassId: 1049066022 }
    ];

    const listings = document.getElementById('listings');
    const modal = document.getElementById('buyModal');
    const title = document.getElementById('buyTitle');
    const desc = document.getElementById('buyDesc');
    const amount = document.getElementById('rbxAmount');

    let selectedItem = null;

    items.forEach(item => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <h3>${item.name}</h3>
        <p class="muted">${item.desc}</p>
        <p class="price">${item.price} R$</p>
        <button class="buy">Buy</button>
      `;
      card.querySelector('.buy').onclick = () => openBuy(item);
      listings.appendChild(card);
    });

    function openBuy(item) {
      selectedItem = item;
      title.textContent = item.name;
      desc.textContent = item.desc;
      amount.value = item.price + ' R$';
      modal.classList.add('active');
    }

    async function confirmBuy() {
      const user = rbxUser.value.trim();
      const emailVal = email.value.trim();
      const discordVal = discord.value.trim() || 'N/A';
      if (!user || !emailVal) return alert('Username and email required');

      const orderId = 'NM-' + Math.random().toString(36).slice(2, 10).toUpperCase();

      if (WEBHOOK_URL.startsWith('http')) {
        fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ embeds: [{ title: ' New Order', fields: [
            { name: 'Order ID', value: orderId },
            { name: 'Item', value: selectedItem.name },
            { name: 'Price', value: selectedItem.price + ' R$' },
            { name: 'Roblox User', value: user },
            { name: 'Email', value: emailVal },
            { name: 'Discord', value: discordVal },
            { name: 'Gamepass', value: String(selectedItem.gamepassId) }
          ]}] })
        });
      }

      // ALWAYS redirect to gamepass
      window.location.href = `https://www.roblox.com/game-pass/${selectedItem.gamepassId}`;
    }
  </script>
</body>
</html>


